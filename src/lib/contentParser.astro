---
import { getCollection, type CollectionEntry, type CollectionKey } from 'astro:content';
import { resolveLang } from './utils/lang';

export const getSinglePage = async <C extends CollectionKey>(
  collectionName: C,
  lang?: string,
): Promise<CollectionEntry<C>[]> => {
  const resolvedLang = resolveLang(lang);

  const allPages = await getCollection(collectionName);

  return allPages
    .filter((entry) => entry.id.startsWith(`${resolvedLang}/`))
    .filter((entry) => !entry.id.startsWith('-'))
    .filter((entry) => !entry.data.draft);
};
---
